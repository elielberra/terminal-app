#include <tunables/global>

profile terminal-app {

	# terminal-app files
	/app/terminal-app                 ix,
	/app/**                           r,
	/app/                             r,

	# shared libraries
	/lib/**                           mr,
	/usr/lib/**                       mr,

	# terminals
	/dev/ptmx        rw,
	/dev/pts/**      rw,
	/usr/bin/rbash  rmix,
	/usr/bin/bash   rmix,
	/usr/bin/dircolors  ix,

	# bash files
	/etc/bash.bashrc        r,
	/home/web-user/.bashrc  r,

	# sockets
	network inet stream,

	# Only allow Docker (unconfined) to stop this app with TERM or KILL
	signal (receive) set=(term,kill) peer=unconfined,

	# ---- Permit running ONLY a few commands
	/usr/bin/cat            ix,
	/usr/bin/ls             ix,
	/usr/bin/mpv			ix,
	/usr/bin/sleep          ix,
	/usr/bin/tr	            ix,
	/usr/bin/clear          ix,
	/usr/bin/date 			ix,
	/usr/bin/eliel			rix,
	/usr/bin/curl			ix, # TODO: Remove curl and ping for prod
	/usr/bin/ping			ix,

	# MPV files
	/etc/fonts/fonts.conf      r,

	# devices
	/dev/null			w,
}
